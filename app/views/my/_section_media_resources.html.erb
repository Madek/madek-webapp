<%=

mods = []
is_main = (true if params[:action] == 'dashboard')
# HACK: toggle box via propâ€¦
with_box = (true if !is_main)
mods << ['rounded-right', { bordered: false }] if !is_main
mods << 'unpaginated' if (local_assigns[:show_pagination_nav] == false)
fallback = section[:is_empty?] ? true : false

# HACK: do async render if set AND if on main dashboard
render_async = (is_main && section[:render_async?]) or false

if !render_async
  react('Deco.MediaResourcesBox',
      get: @get.send(section[:id]),
      mods: mods,
      withBox: with_box,
      fallback: fallback,
      initial: { show_filter: false })

else
  react(
    'AsyncDashboardSection',
    component: 'Deco.MediaResourcesBox',
    # NOTE: we don't want to fetch the actual subsection, which has diff. content.
    #       instead, we use the 'sparse request', to just fetch what we need.
    url: my_dashboard_path(section[:id], format: :json) +
          '?___sparse={"' + section[:id].to_s + '":{}}',
    json_path: section[:id].to_s,
    initial_props: {
      mods: mods,
      withBox: with_box,
      fallback: fallback,
      initial: { show_filter: false }})
end

  %>
