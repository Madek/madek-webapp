"Ruby Lint":

  include: cider-ci/context-components/ruby-setup.yml

  tasks:

    code-complexity-flog:
      name: "Ruby: Code complexity with flog"
      scripts:
        test:
          body: |
            set -eux
            export PATH=~/.rubies/$RUBY/bin:$PATH
            bundle exec cider-ci_flog -m app/ \
            -e app/controllers/oembed_controller.rb \
            -e app/lib/embed_helper.rb \
            -e app/presenters/presenters/meta_data/meta_datum_edit.rb \
            -e app/controllers/concerns/my/dashboard_sections.rb
            # NOTE: â†‘ DEPRECATE_LICENSES
            # oembed: disabled because its a mini-embedded-api (special case)
            # embed helper: because the math has to go somewhere

    code-similarity:
      name: "Ruby: Code similarity with flay"
      scripts:
        test:
          body: |
            set -eux
            export PATH=~/.rubies/$RUBY/bin:$PATH
            bundle exec cider-ci_flay -m 45 app/

    lint-ruby:
      name: "Ruby: Lint/Stylecheck with Rubocop"
      scripts:
        test:
          body: |
            set -eux
            export PATH=~/.rubies/$RUBY/bin:$PATH
            bundle exec rubocop
